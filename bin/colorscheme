#!/bin/bash
# gcolorscheme.sh - Switch between light and dark mode
# g@author umutsevdi 
# g@requires i3, xsettingsd

color_value=`cat /tmp/colorscheme 2>/dev/null`
[ $color_value = "" ] && color_value=false

GTK_THEME_LIGHT="Qogir-Light"
GTK_THEME_DARK="Qogir-Dark"
CIN_THEME_DOCK_LIGHT="Orchis-Purple-Light-Compact"
CIN_THEME_LIGHT="Orchis-Purple-Light-Compact"
CIN_THEME_DARK="Orchis-Purple-Dark-Compact"

VIM_THEME_DARK="palenight"
VIM_THEME_LIGHT="lighter"
VIM_THEME_TYPE="material_theme_style"
GTK_ICON_LIGHT="Sevi-dark"
GTK_ICON_DARK="Sevi-dark"
CIN_ICON_LIGHT="Breeze_RC"
CIN_ICON_DARK="Breeze_Dark_RC"

Help()
{
   # gDisplay Help
   echo "colorscheme.sh - Toggle between light and dark mode"
   echo
   echo "Syntax: [-r]"
   echo
   echo "Options:"
   echo "-h/--help          Prints this menu."
   echo "-r/--refresh       Refreshes the display"
   echo
}

Set()
{
    if [ "$is_dark" = true ]; then 
        gtk_theme=$GTK_THEME_LIGHT
        gtk_icon=$GTK_ICON_LIGHT
        cin_theme=$CIN_THEME_LIGHT
        cin_icon=$CIN_ICON_LIGHT
        cin_dock=$CIN_THEME_DOCK_LIGHT
        # gnome_prefer="prefer-light"
        sed -i s/"vim.g.$VIM_THEME_TYPE = '$VIM_THEME_DARK"/"vim.g.$VIM_THEME_TYPE = '$VIM_THEME_LIGHT"/ $HOME/.dotfiles/nvim/pkg/colorscheme.lua
        sed -i s/"set background=dark"/"set background=light"/ $HOME/.dotfiles/nvim/pkg/colorscheme.lua
        cat $HOME/.dotfiles/alacritty/base.yaml $HOME/.dotfiles/alacritty/light.yaml > $HOME/.config/alacritty/alacritty.yml
    else
        gtk_theme=$GTK_THEME_DARK
        cin_theme=$CIN_THEME_DARK
        gtk_icon=$GTK_ICON_DARK
        cin_icon=$CIN_ICON_DARK
        cin_dock=$CIN_THEME_DARK
        # gnome_prefer="prefer-dark"
        sed -i s/"vim.g.$VIM_THEME_TYPE = '$VIM_THEME_LIGHT"/"vim.g.$VIM_THEME_TYPE = '$VIM_THEME_DARK"/ $HOME/.dotfiles/nvim/pkg/colorscheme.lua
        sed -i s/"set background=light"/"set background=dark"/ $HOME/.dotfiles/nvim/pkg/colorscheme.lua
        cat $HOME/.dotfiles/alacritty/base.yaml $HOME/.dotfiles/alacritty/dark.yaml > $HOME/.config/alacritty/alacritty.yml
    fi
    gsettings set org.gnome.desktop.interface gtk-theme "$gtk_theme"
    gsettings set org.gnome.desktop.interface icon-theme "$gtk_icon"
    # ggsettings set org.gnome.desktop.interface color-scheme "$gnome_prefer"
    gsettings set org.gnome.desktop.wm.preferences theme "$gtk_theme"
    gsettings set org.gnome.desktop.interface gtk-key-theme "$gtk_theme" 

    gsettings set org.cinnamon.desktop.interface gtk-theme "$cin_theme"
    gsettings set org.cinnamon.desktop.interface icon-theme "$cin_icon"
    gsettings set org.cinnamon.desktop.wm.preferences theme "$cin_theme"
    gsettings set org.cinnamon.desktop.interface gtk-key-theme "$cin_theme" 
    gsettings set org.cinnamon.theme name "$cin_dock" 
}

for arg in $@;do
    if   [ "$arg" = "-h" ] || [ "$arg" = "--help" ]; then
        Help
        exit
    elif [ "$arg" = "-r" ] || [ "$arg" = "--refresh" ]; then 
        refresh=true
    else
        echo -e "Error: Invalid arguments" 1>&2
        exit
    fi 
done

if [ "$refresh" = true  ];then
    is_dark=`if [ "$color_value" = true ]; then echo false; else echo true; fi`
else
    is_dark=`if [ "$color_value" = true ]; then echo true; else echo false; fi`
    write=`if [ "$color_value" = true ]; then echo false; else echo true; fi`
    echo $write > /tmp/colorscheme
fi
Set

